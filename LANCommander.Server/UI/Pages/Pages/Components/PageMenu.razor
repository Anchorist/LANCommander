@using Microsoft.EntityFrameworkCore
@inherits OwningComponentBase

<Menu Mode="@MenuMode.Inline">
    @foreach (var parent in ParentPages)
    {
        <PageMenuItem Page="@parent" />
    }
</Menu>

@code {
    PageService PageService;

    ICollection<Page> ParentPages = new List<Page>();

    protected override void OnInitialized()
    {
        PageService = ScopedServices.GetService<PageService>()!;
    }

    protected override async Task OnInitializedAsync()
    {
        ParentPages = (await PageService.GetAsync(p => p.ParentId == null || p.ParentId == Guid.Empty)).OrderBy(p => p.SortOrder).ToList();
    }
}
